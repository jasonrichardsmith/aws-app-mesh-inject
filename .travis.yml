language: go
go: 1.12.x
dist: xenial
addons:
  snaps:
    - name: microk8s
      classic: true
sudo: true
services:
- docker
install: true
notifications:
  email: false
env:
  - TEST_SUITE=ci-test-build
  - TEST_SUITE=travis-e2e
before_install:
  - go get github.com/mattn/goveralls
  - export GO111MODULE=on
  - export MESH_REGION=test
  - export MESH_NAME=test
  - sudo snap alias microk8s.kubectl kubectl
  - sudo microk8s.start
script: 
  - "make $TEST_SUITE"
after_success:
  - test -n "$TRAVIS_TAG" && make build && make push
